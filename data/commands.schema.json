{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "TL1 Commands Database Schema",
  "description": "Schema for validating the TL1 commands.json file",
  "type": "object",
  "properties": {
    "metadata": {
      "type": "object",
      "properties": {
        "version": {
          "type": "string",
          "pattern": "^[0-9]+\\.[0-9]+$"
        },
        "lastUpdate": {
          "type": "string",
          "format": "date"
        },
        "totalCommands": {
          "type": "integer",
          "minimum": 0
        },
        "platforms": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["1603 SM", "1603 SMX"]
          },
          "minItems": 1
        },
        "description": {
          "type": "string"
        },
        "source": {
          "type": "string"
        }
      },
      "required": ["version", "lastUpdate", "totalCommands", "platforms"],
      "additionalProperties": false
    },
    "categories": {
      "type": "object",
      "patternProperties": {
        "^[A-Za-z0-9 &-]+$": {
          "type": "object",
          "properties": {
            "description": {
              "type": "string"
            },
            "icon": {
              "type": "string"
            }
          },
          "required": ["description", "icon"],
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "commands": {
      "type": "object",
      "patternProperties": {
        "^[A-Z0-9-]+$": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string"
            },
            "displayName": {
              "type": "string"
            },
            "platforms": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": ["1603 SM", "1603 SMX"]
              },
              "minItems": 1
            },
            "category": {
              "type": "string"
            },
            "verb": {
              "type": "string",
              "pattern": "^[A-Z]+$"
            },
            "object": {
              "type": "string",
              "pattern": "^[A-Z0-9-]+$"
            },
            "modifier": {
              "type": ["string", "null"],
              "pattern": "^[A-Z0-9-]*$"
            },
            "description": {
              "type": "string"
            },
            "syntax": {
              "type": "string",
              "pattern": ".*;$"
            },
            "requires": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": ["TID", "AID", "CTAG"]
              }
            },
            "optional": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "response_format": {
              "type": "string"
            },
            "safety_level": {
              "type": "string",
              "enum": ["safe", "caution", "dangerous"]
            },
            "service_affecting": {
              "type": "boolean"
            },
            "examples": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "paramSchema": {
              "type": "object",
              "patternProperties": {
                "^[A-Z0-9_]+$": {
                  "type": "object",
                  "properties": {
                    "type": {
                      "type": "string",
                      "enum": ["string", "integer", "boolean"]
                    },
                    "maxLength": {
                      "type": "integer",
                      "minimum": 1
                    },
                    "minimum": {
                      "type": "integer"
                    },
                    "maximum": {
                      "type": "integer"
                    },
                    "description": {
                      "type": "string"
                    },
                    "enum": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "required": ["type", "description"],
                  "additionalProperties": false
                }
              },
              "additionalProperties": false
            }
          },
          "required": [
            "id", "displayName", "platforms", "category", "verb", "object", 
            "description", "syntax", "requires", "response_format", 
            "safety_level", "service_affecting"
          ],
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    }
  },
  "required": ["metadata", "categories", "commands"],
  "additionalProperties": false
}